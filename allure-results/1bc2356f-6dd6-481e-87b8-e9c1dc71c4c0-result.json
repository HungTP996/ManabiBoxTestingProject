{"name": "test_drawing_and_visual_verification[chromium]", "status": "broken", "statusDetails": {"message": "AttributeError: 'LocatorAssertions' object has no attribute 'to_have_screenshot'", "trace": "drawing_page = <Page url='https://digistudy.sing.jp/drill/language/question?id=534965'>\n\n    def test_drawing_and_visual_verification(drawing_page: Page):\n        \"\"\"\n        Test kịch bản vẽ và xác minh kết quả bằng cách so sánh ảnh chụp màn hình.\n        \"\"\"\n        # 'page' bây giờ đã ở sẵn trên trang vẽ nhờ fixture\n        page = drawing_page\n    \n        # --- Mô phỏng hành động vẽ ---\n        print(\"--- Bắt đầu vẽ ---\")\n        # !!! THAY THẾ BẰNG LOCATOR CỦA BẢNG VẼ LỚN !!!\n        drawing_canvas = page.locator(\".kanji-canvas.upper-canvas\")\n        # Đảm bảo canvas đã hiển thị trước khi lấy tọa độ\n        expect(drawing_canvas).to_be_visible()\n        canvas_box = drawing_canvas.bounding_box()\n    \n        # Tọa độ gốc để tính toán các nét vẽ\n        origin_x = canvas_box['x']\n        origin_y = canvas_box['y']\n    \n        print(\"\\n--- Bắt đầu vẽ chữ 「かわ」 ---\")\n    \n        # ===================================================================\n        # == Vẽ chữ「か」 (ka) ==\n        # ===================================================================\n        print(\"--> Đang vẽ chữ 「か」...\")\n        # Bắt đầu nét vẽ\n        page.mouse.move(origin_x + 100, origin_y + 70)\n        page.mouse.down()\n        # 1. Kéo sang ngang\n        page.mouse.move(origin_x + 210, origin_y + 50)\n        # 2. Kéo chéo xuống phía bên trái\n        page.mouse.move(origin_x + 180, origin_y + 180)\n        # 3. Tạo móc câu quặt vào trong (hơi đi lên và sang phải)\n        page.mouse.move(origin_x + 170, origin_y + 170)\n        # Kết thúc nét vẽ\n        page.mouse.up()\n        # # ===================================================================\n        # # == Nét ②: Nét sổ thẳng ==\n        # # ===================================================================\n        print(\"--> Đang vẽ Nét ②...\")\n        # Bắt đầu từ phía trên, bên phải nét 1\n        page.mouse.move(origin_x + 140, origin_y + 40)\n        page.mouse.down()\n        # Kéo một nét thẳng ngắn chạm vào nét 1\n        page.mouse.move(origin_x + 100, origin_y + 160)\n        page.mouse.up()\n        # ===================================================================\n        # == Nét ③: Nét phẩy (dấu \"ten\") ==\n        # ===================================================================\n        print(\"--> Đang vẽ Nét ③...\")\n        # Bắt đầu ở khoảng trống trên bên phải\n        page.mouse.move(origin_x + 200, origin_y + 60)\n        page.mouse.down()\n        # Vẽ một dấu phẩy ngắn\n        page.mouse.move(origin_x + 230, origin_y + 80)\n        page.mouse.up()\n        # ===================================================================\n        # == Vẽ chữ「わ」 (wa) ==\n        # ===================================================================\n        print(\"--> Đang vẽ chữ 「わ」...\")\n        # Nét 1: Nét sổ thẳng\n        page.mouse.move(origin_x + 100, origin_y + 200)\n        page.mouse.down()\n        page.mouse.move(origin_x + 90, origin_y + 320)\n        page.mouse.up()\n    \n        # nét kéo sang ngang\n        page.mouse.move(origin_x + 90, origin_y + 220)\n        page.mouse.down()\n        page.mouse.move(origin_x + 170, origin_y + 180)\n        # Phần 1: Kéo chéo xuống dưới về phía bên trái\n        page.mouse.move(origin_x + 50, origin_y + 300)\n        # Phần 2: Lượn sang ngang về phía bên phải (giống chữ 'Z')\n        page.mouse.move(origin_x + 190, origin_y + 210)\n        # Bắt đầu vòng xuống và sang trái\n        page.mouse.move(origin_x + 200, origin_y + 275)\n        # Điểm thấp nhất của vòng cung, ở gần trung tâm\n        page.mouse.move(origin_x + 150, origin_y + 320)\n        page.mouse.up()\n        print(\"--- Vẽ xong ---\")\n        # 1. Click nút \"決定\" bằng locator bạn cung cấp\n        # Locator này tìm thẻ div thứ 3 có text chính xác là \"決定\"\n        kettei_button = page.locator(\"div\").filter(has_text=re.compile(r\"^決けっ定てい$\")).nth(2)\n        kettei_button.click()\n        print(\"-> Đã click nút '決定'.\")\n    \n        # 2. Click nút \"こたえあわせ\"\n        kotaeawase_button = page.get_by_role(\"button\", name=\"こたえあわせ\")\n        kotaeawase_button.click()\n        print(\"-> Đã click nút 'こたえあわせ'.\")\n        # --- Kiểm tra kết quả bằng Visual Test ---\n        # !!! THAY THẾ BẰNG LOCATOR CỦA Ô KẾT QUẢ NHỎ MÀU ĐỎ !!!\n        result_box = page.locator(\"#result_red_box\")\n    \n        print(\"-> Chụp ảnh và so sánh với ảnh chuẩn...\")\n>       expect(result_box).to_have_screenshot(\"drawing_result.png\")\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nE       AttributeError: 'LocatorAssertions' object has no attribute 'to_have_screenshot'\n\ntests\\kokugo\\kaigara\\test_kaigara_pre.py:132: AttributeError"}, "description": "\nTest kịch bản vẽ và xác minh kết quả bằng cách so sánh ảnh chụp màn hình.\n", "attachments": [{"name": "stdout", "source": "5b3a5f75-d9f5-4a96-87df-0642c9623c64-attachment.txt", "type": "text/plain"}], "parameters": [{"name": "browser_name", "value": "'chromium'"}], "start": 1757905608880, "stop": 1757905609243, "uuid": "edb40a7d-2800-47e7-96ca-5b1543c06ddc", "historyId": "d02d6e3b34b743704089ae74fe71fc5e", "testCaseId": "693ce0d4d345355f2a39f8cf6337af73", "fullName": "tests.kokugo.kaigara.test_kaigara_pre#test_drawing_and_visual_verification", "labels": [{"name": "parentSuite", "value": "tests.kokugo.kaigara"}, {"name": "suite", "value": "test_kaigara_pre"}, {"name": "host", "value": "DESKTOP-ID4K0T4"}, {"name": "thread", "value": "3872-MainThread"}, {"name": "framework", "value": "pytest"}, {"name": "language", "value": "cpython3"}, {"name": "package", "value": "tests.kokugo.kaigara.test_kaigara_pre"}], "titlePath": ["tests", "kokugo", "kaigara", "test_kaigara_pre.py"]}